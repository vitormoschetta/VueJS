<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Primeiro SPA</title>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>    
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>  
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>

<body>
    <div class="card">  
        <div class="card-body">

            <div id="app">
                        
                <input type="button" v-on:click="GetProducts" value="Mostrar Produtos">
                <input type="button" v-on:click="CreateProduct()" value="Novo">

                <table class="table table-hover table-sm">
                    <thead style="font-weight: bold;">
                        <tr>
                            <td>ID</td>
                            <td>Name</td>
                            <td>Price</td>
                            <td>Actions</td>                      
                        </tr>
                    </thead>

                    <tbody>
                        <tr v-for="product in lista">
                            <td>{{ product.id }}</td>
                            <td>{{ product.name }}</td>
                            <td>{{ product.price }}</td>
                            <td>
                                <router-link :to="{name: 'edit_product', params: { id: product.id }}" class="btn btn-primary">Edit</router-link>
                                <router-link :to="{name: 'delete_product', params: { id: product.id }}" class="btn btn-danger">Delete</router-link>                        
                            </td>
                        </tr>
                    </tbody>
                </table>

                <hr>       


                <div class="row">
                    <div class="col">
                        <input type="text" v-model="name">
                        <input type="text" v-model="price">                
                    </div>
                    <div class="col">
                        <input type="button" v-on:click="CreateProduct()" value="Create Product">
                    </div>
                </div>
            </div>

        </div>
    </div>

    
    <script>          

        new Vue({
            el: "#app",
            data: {  
                lista: new Array(),                      
            },
            
            methods: {
                
                GetProducts: function (events) {
                    axios
                        .get('http://localhost/DefaultApiAndUi/api/product')
                        .then(response => (this.lista = response.data))        
                        .catch(error => console.log(error))      
                },

                GetProduct: function (events, id) {
                    axios
                        .get('http://localhost/DefaultApiAndUi/api/product/' + id)
                        .then(response => (this.product = response.data))        
                        .catch(error => console.log(error))      
                },

                CreateProduct: function (events) {
                    product = Product;
                    product = {"name": this.name, "price": this.price}

                    axios
                        .post('http://localhost/DefaultApiAndUi/api/product/', product)
                        .then(response => (this.product = response.data))        
                        .catch(error => console.log(error))      
                },

                DeleteProduct: function (events, id) {    
                    axios
                        .get('http://localhost/DefaultApiAndUi/api/product/' + id)
                        .then(response => (this.product = response.data))        
                        .catch(error => console.log(error))          
                },
                
            }
        })      


    </script>

</body>
</html>